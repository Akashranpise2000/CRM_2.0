(()=>{var e={};e.id=1931,e.ids=[1931],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},82414:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>x,routeModule:()=>h,tree:()=>o});var a=s(73137),l=s(54647),r=s(4183),n=s.n(r),i=s(71775),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let d=a.AppPageRouteModule,o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,54165)),"d:\\ACPL ALL Projects\\5th Projects\\CRM_2.0\\CRM-main\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7664)),"d:\\ACPL ALL Projects\\5th Projects\\CRM_2.0\\CRM-main\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,51918,23)),"next/dist/client/components/not-found-error"]}],x=["d:\\ACPL ALL Projects\\5th Projects\\CRM_2.0\\CRM-main\\app\\page.tsx"],m="/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new d({definition:{kind:l.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},93212:(e,t,s)=>{Promise.resolve().then(s.bind(s,96679))},96679:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ec});var a=s(60080),l=s(9885),r=s(57114),n=s(97052),i=s(24796),c=s(96253),d=s(43917),o=s(50007),x=s(34706),m=s(22388),u=s(15441),h=s(70696),p=s(50451),j=s(68384),g=s(89815),f=s(3514),N=s(20644);function v({lastUpdated:e,refreshing:t,notifications:s,onRefresh:l}){return(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[a.jsx("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:a.jsx(g.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Dashboard"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Live updates active"}),a.jsx("span",{children:"•"}),(0,a.jsxs)("span",{children:["Last updated: ",(0,p.ZP)(e,"MMM dd, HH:mm")]})]})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(f.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[s," notifications"]})]}),(0,a.jsxs)(j.z,{onClick:l,disabled:t,className:"flex items-center gap-2",variant:"outline",children:[a.jsx(N.Z,{className:`h-4 w-4 ${t?"animate-spin":""}`}),"Refresh"]})]})]})}var w=s(54328),b=s(23161);let y=l.forwardRef(({className:e,value:t,...s},l)=>a.jsx(w.fC,{ref:l,className:(0,b.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:a.jsx(w.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));y.displayName=w.fC.displayName;var Z=s(66908),_=s(51443),C=s(76494);function D({metrics:e,animateCards:t}){return(0,a.jsxs)("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(n.Zb,{className:`transition-all duration-700 hover:shadow-lg hover:scale-[1.02] ${t?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Total Revenue"}),a.jsx("div",{className:"p-2 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full",children:a.jsx(Z.Z,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl sm:text-3xl font-bold text-green-600",children:["₹",e.totalRevenue.toLocaleString()]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsxs)(i.C,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:[a.jsx(_.Z,{className:"h-3 w-3 mr-1"}),"+12.5%"]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"vs last month"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:[e.wonOpportunities," deals won"]})]})]}),(0,a.jsxs)(n.Zb,{className:`transition-all duration-700 hover:shadow-lg hover:scale-[1.02] ${t?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{transitionDelay:"100ms"},children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Win Rate"}),a.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-full",children:a.jsx(h.Z,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl sm:text-3xl font-bold text-blue-600",children:[e.winRate.toFixed(1),"%"]}),(0,a.jsxs)("div",{className:"mt-2",children:[a.jsx(y,{value:e.winRate,className:"h-2"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.wonOpportunities," of ",e.totalOpportunities," deals won"]})]})]})]}),(0,a.jsxs)(n.Zb,{className:`transition-all duration-700 hover:shadow-lg hover:scale-[1.02] ${t?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{transitionDelay:"200ms"},children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Pipeline Value"}),a.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full",children:a.jsx(o.Z,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl sm:text-3xl font-bold text-purple-600",children:["₹",e.forecastRevenue.toLocaleString()]}),a.jsx("div",{className:"flex items-center gap-2 mt-2",children:(0,a.jsxs)(i.C,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:[e.qualifiedOpportunities," active deals"]})}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Avg: ₹",(e.forecastRevenue/Math.max(e.qualifiedOpportunities,1)).toLocaleString()]})]})]}),(0,a.jsxs)(n.Zb,{className:`transition-all duration-700 hover:shadow-lg hover:scale-[1.02] ${t?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{transitionDelay:"300ms"},children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Conversion Rate"}),a.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-400 to-red-500 rounded-full",children:a.jsx(C.Z,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl sm:text-3xl font-bold text-orange-600",children:[e.conversionRate.toFixed(1),"%"]}),(0,a.jsxs)("div",{className:"mt-2",children:[a.jsx(y,{value:e.conversionRate,className:"h-2"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Qualified to won"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Avg deal: ₹",e.avgDealSize.toLocaleString()]})]})]})]})}var L=s(63647),O=s(84753),S=s(35522),M=s(14839),P=s(54206),R=s(16692),T=s(97106),k=s(34482),A=s(98741),F=s(8081),Y=s(16324),E=s(44723);let $=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"];function q({revenueTrendData:e,pipelineData:t,sectorData:s}){return(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(g.Z,{className:"h-5 w-5 text-blue-600"}),"Revenue Trend & Targets"]})}),a.jsx(n.aY,{children:a.jsx(L.h,{width:"100%",height:300,children:(0,a.jsxs)(O.T,{data:e,children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),a.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),(0,a.jsxs)("linearGradient",{id:"colorTarget",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.2}),a.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]})]}),a.jsx(S.K,{dataKey:"month"}),a.jsx(M.B,{}),a.jsx(P.u,{formatter:(e,t)=>[`₹${Number(e).toLocaleString()}`,t],labelStyle:{color:"#374151"}}),a.jsx(R.u,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",fillOpacity:1,fill:"url(#colorRevenue)",strokeWidth:2}),a.jsx(T.x,{type:"monotone",dataKey:"target",stroke:"#ef4444",strokeDasharray:"5 5",strokeWidth:2,dot:{fill:"#ef4444",strokeWidth:2,r:4}})]})})})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(h.Z,{className:"h-5 w-5 text-green-600"}),"Sales Pipeline"]})}),(0,a.jsxs)(n.aY,{children:[a.jsx(L.h,{width:"100%",height:300,children:(0,a.jsxs)(k.v,{data:t,layout:"horizontal",children:[a.jsx(S.K,{type:"number"}),a.jsx(M.B,{dataKey:"name",type:"category",width:80}),a.jsx(P.u,{formatter:(e,t)=>[e,"value"===t?"Opportunities":"Value"],labelFormatter:e=>`Stage: ${e}`}),a.jsx(A.$,{dataKey:"value",radius:[0,4,4,0],children:t.map((e,t)=>a.jsx(F.b,{fill:e.color},`cell-${t}`))})]})}),a.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2 text-xs",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[e.name,": ",e.value]})]},t))})]})]})]})}function z({sectorData:e}){return(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(h.Z,{className:"h-5 w-5 text-yellow-600"}),"Revenue by Sector"]})}),(0,a.jsxs)(n.aY,{children:[a.jsx(L.h,{width:"100%",height:250,children:(0,a.jsxs)(Y.u,{children:[a.jsx(E.b,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:e=>e.name.length>8?e.name.substring(0,8)+"...":e.name,outerRadius:60,fill:"#8884d8",dataKey:"value",children:e.map((e,t)=>a.jsx(F.b,{fill:$[t%$.length]},`cell-${t}`))}),a.jsx(P.u,{formatter:e=>`₹${Number(e).toLocaleString()}`})]})}),a.jsx("div",{className:"mt-4 space-y-2",children:e.slice(0,3).map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"font-semibold",children:["₹",e.value.toLocaleString()]}),(0,a.jsxs)("span",{className:"text-xs px-2 py-1 bg-muted rounded",children:[e.winRate.toFixed(0),"% win"]})]})]},t))})]})]})}var H=s(517),W=s(91672),K=s(48895),G=s(75923);function V({activities:e,opportunities:t,contacts:s}){let l=e.filter(e=>(0,K.Z)(new Date(e.start_time))),r=e.filter(e=>e.type.toLowerCase().includes("follow")&&(0,K.Z)(new Date(e.start_time))),c=t.filter(e=>{let t=new Date(e.close_date||Date.now()),s=(0,G.Z)(new Date,-7);return t>=s&&t<=new Date}),d=t.filter(e=>"closed_win"===e.status),x=t.filter(e=>"lost"===e.status),m=t.filter(e=>e.close_date&&new Date(e.close_date)<=(0,G.Z)(new Date,30)&&new Date(e.close_date)>=new Date&&e.amount>=1e4);return(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-4",children:[(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Today's Tasks"}),a.jsx(H.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:l.length}),a.jsx("div",{className:"flex items-center gap-2 mt-2",children:r.length>0&&(0,a.jsxs)(i.C,{variant:"destructive",className:"text-xs",children:[r.length," follow-ups"]})}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:[l.filter(e=>"completed"===e.status).length," completed"]})]})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"New Opportunities"}),a.jsx(o.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:c.length}),a.jsx("div",{className:"flex items-center gap-2 mt-2",children:a.jsx(i.C,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:"This week"})}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Total value: ₹",c.reduce((e,t)=>e+t.amount,0).toLocaleString()]})]})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"This Month"}),a.jsx(h.Z,{className:"h-4 w-4 text-purple-600"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-xl font-bold text-green-600",children:d.length}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Won"})]}),(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-xl font-bold text-red-600",children:x.length}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Lost"})]})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Win rate: ",d.length+x.length>0?(d.length/(d.length+x.length)*100).toFixed(1):0,"%"]})]})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Big Deals Closing"}),a.jsx(Z.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:m.length}),a.jsx("div",{className:"flex items-center gap-2 mt-2",children:a.jsx(i.C,{variant:"secondary",className:"text-xs bg-orange-100 text-orange-700",children:"Next 30 days"})}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Total: ₹",m.reduce((e,t)=>e+t.amount,0).toLocaleString()]})]})]})]})}function B({opportunities:e}){let t=e.filter(e=>"quality"===e.status),s=t.filter(e=>"high"===e.priority&&e.probability>50),l=t.filter(e=>"medium"===e.priority&&e.probability>30),r=t.filter(e=>"low"===e.priority||e.probability<=30);return(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(W.Z,{className:"h-5 w-5 text-blue-600"}),"Leads Summary"]})}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg bg-red-50 dark:bg-red-950/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(d.Z,{className:"h-4 w-4 text-red-600"}),a.jsx("span",{className:"text-sm font-medium",children:"Hot Leads"})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"font-bold text-red-600",children:s.length}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["₹",s.reduce((e,t)=>e+t.amount,0).toLocaleString()]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg bg-yellow-50 dark:bg-yellow-950/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(u.Z,{className:"h-4 w-4 text-yellow-600"}),a.jsx("span",{className:"text-sm font-medium",children:"Warm Leads"})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"font-bold text-yellow-600",children:l.length}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["₹",l.reduce((e,t)=>e+t.amount,0).toLocaleString()]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg bg-blue-50 dark:bg-blue-950/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(c.Z,{className:"h-4 w-4 text-blue-600"}),a.jsx("span",{className:"text-sm font-medium",children:"Cold Leads"})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"font-bold text-blue-600",children:r.length}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["₹",r.reduce((e,t)=>e+t.amount,0).toLocaleString()]})]})]})]})})]})}var Q=s(20987),U=s(78260),I=s(6867),J=s(67932);function X({opportunities:e,expenses:t,contacts:s,companies:l}){return(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-4",children:[(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Opportunities"}),a.jsx(h.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:e.length}),(0,a.jsxs)("div",{className:"mt-2",children:[a.jsx(y,{value:e.filter(e=>"closed_win"===e.status).length/e.length*100,className:"h-2"}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[e.filter(e=>"closed_win"===e.status).length," won"]})]})]})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Active Projects"}),a.jsx(Q.Z,{className:"h-4 w-4 text-green-600"})]}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:e.filter(e=>["qualified","proposal","negotiation"].includes(e.status)).length}),a.jsx("div",{className:"mt-2",children:a.jsx(i.C,{variant:"secondary",className:"text-xs bg-green-100 text-green-700",children:"In progress"})}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Avg value: ₹",Math.round(e.filter(e=>["qualified","proposal","negotiation"].includes(e.status)).reduce((e,t)=>e+t.amount,0)/Math.max(e.filter(e=>["qualified","proposal","negotiation"].includes(e.status)).length,1)).toLocaleString()]})]})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Total Expenses"}),a.jsx(U.Z,{className:"h-4 w-4 text-red-600"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-red-600",children:["₹",t.reduce((e,t)=>e+t.amount,0).toLocaleString()]}),a.jsx("div",{className:"mt-2",children:a.jsx(i.C,{variant:"secondary",className:"text-xs bg-red-100 text-red-700",children:"This month"})}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:[t.length," transactions"]})]})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-sm font-medium",children:"Success Rate"}),a.jsx(o.Z,{className:"h-4 w-4 text-purple-600"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[e.length>0?(e.filter(e=>"closed_win"===e.status).length/e.length*100).toFixed(1):0,"%"]}),a.jsx("div",{className:"mt-2",children:a.jsx(y,{value:e.length>0?e.filter(e=>"closed_win"===e.status).length/e.length*100:0,className:"h-2"})}),a.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:"Win rate this quarter"})]})]})]})}function ee({expenses:e}){let t=e.filter(e=>e.category?.toLowerCase().includes("food")||e.category?.toLowerCase().includes("meal")||e.title.toLowerCase().includes("food")||e.title.toLowerCase().includes("meal")||e.title.toLowerCase().includes("restaurant")),s=e.filter(e=>e.category?.toLowerCase().includes("travel")||e.category?.toLowerCase().includes("transport")||e.title.toLowerCase().includes("travel")||e.title.toLowerCase().includes("flight")||e.title.toLowerCase().includes("hotel")),l=t.reduce((e,t)=>e+t.amount,0),r=s.reduce((e,t)=>e+t.amount,0);return(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(I.Z,{className:"h-5 w-5 text-blue-600"}),"Food & Travel Expenses"]})}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg bg-blue-50 dark:bg-blue-950/20",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-sm font-medium",children:"Food & Dining"})}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-bold",children:["₹",l.toLocaleString()]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[t.length," items"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg bg-green-50 dark:bg-green-950/20",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-sm font-medium",children:"Travel & Transport"})}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-bold",children:["₹",r.toLocaleString()]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[s.length," items"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg bg-muted",children:[a.jsx("span",{className:"font-medium",children:"Total"}),(0,a.jsxs)("span",{className:"font-bold",children:["₹",(l+r).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-muted-foreground",children:["Last updated: ",new Date().toLocaleDateString()]})]})})]})}function et({opportunities:e}){let t=[{stage:"quality",name:"Quality",color:"#6366f1",count:0},{stage:"meet_contact",name:"Meet Contact",color:"#3b82f6",count:0},{stage:"meet_present",name:"Meet & Present",color:"#06b6d4",count:0},{stage:"purpose",name:"Purpose",color:"#10b981",count:0},{stage:"negotiate",name:"Negotiate",color:"#f59e0b",count:0},{stage:"closed_win",name:"Won",color:"#22c55e",count:0},{stage:"lost",name:"Lost",color:"#ef4444",count:0}].map(t=>({...t,count:e.filter(e=>e.status===t.stage).length,percentage:e.length>0?e.filter(e=>e.status===t.stage).length/e.length*100:0}));return(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(J.Z,{className:"h-5 w-5 text-yellow-600"}),"Pipeline Stage Distribution"]})}),(0,a.jsxs)(n.aY,{children:[a.jsx("div",{className:"space-y-3",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),a.jsx("span",{className:"text-sm",children:e.name})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium",children:e.count}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.percentage.toFixed(1),"%)"]})]})]},e.stage))}),a.jsx("div",{className:"mt-4 p-3 rounded-lg bg-muted",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-lg font-bold",children:e.length}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Opportunities"})]})})]})]})}var es=s(86546);function ea({activities:e}){let t=e.filter(e=>(0,K.Z)(new Date(e.start_time))).sort((e,t)=>new Date(e.start_time).getTime()-new Date(t.start_time).getTime()),s=e.filter(e=>"scheduled"===e.status&&new Date(e.start_time)>new Date&&e.type.toLowerCase().includes("follow")).sort((e,t)=>new Date(e.start_time).getTime()-new Date(t.start_time).getTime()).slice(0,5),l=e.filter(e=>"scheduled"===e.status&&(0,es.Z)(new Date(e.start_time))).slice(0,5);return(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(H.Z,{className:"h-5 w-5 text-blue-600"}),"Today's Schedule",a.jsx(i.C,{variant:"outline",className:"ml-auto",children:t.length})]})}),a.jsx(n.aY,{children:a.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:0===t.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(H.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No activities scheduled for today"})]}):t.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 rounded-lg border p-3 transition-all duration-300 hover:shadow-sm hover:bg-muted/50",children:[a.jsx("div",{className:"mt-1 h-2 w-2 rounded-full bg-blue-500 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,p.ZP)(new Date(e.start_time),"HH:mm")," • ",e.type]}),e.contact&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[e.contact.first_name," ",e.contact.last_name]})]}),a.jsx(i.C,{variant:"completed"===e.status?"default":"secondary",className:"text-xs",children:e.status})]},e.id))})})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(u.Z,{className:"h-5 w-5 text-green-600"}),"Upcoming Follow-ups",a.jsx(i.C,{variant:"outline",className:"ml-auto",children:s.length})]})}),a.jsx(n.aY,{children:a.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:0===s.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(u.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No upcoming follow-ups"})]}):s.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 hover:bg-muted/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,p.ZP)(new Date(e.start_time),"MMM dd, HH:mm")," • ",e.type]}),e.contact&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[e.contact.first_name," ",e.contact.last_name]})]}),a.jsx(i.C,{variant:"secondary",className:"text-xs ml-2",children:"Scheduled"})]},e.id))})})]}),l.length>0&&(0,a.jsxs)(n.Zb,{className:"lg:col-span-2 border-l-4 border-l-red-500 bg-red-50 dark:bg-red-950/20",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2 text-red-700 dark:text-red-400",children:[a.jsx(x.Z,{className:"h-5 w-5"}),"Overdue Activities (",l.length,")"]})}),a.jsx(n.aY,{children:a.jsx("div",{className:"space-y-2",children:l.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded bg-red-100 dark:bg-red-900/30",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Due: ",(0,p.ZP)(new Date(e.start_time),"MMM dd, HH:mm")]})]}),a.jsx(i.C,{variant:"destructive",children:"Overdue"})]},e.id))})})]})]})}var el=s(97018);function er({contacts:e,opportunities:t,onNavigateToLeads:s,onNavigateToContacts:l,onNavigateToOpportunities:r}){let c=e.sort((e,t)=>{let s=new Date(e.created_at||0).getTime(),a=new Date(t.created_at||0).getTime();return a-s}).slice(0,5),d=t.filter(e=>!["closed_win","lost"].includes(e.status)).sort((e,t)=>{let s={high:3,medium:2,low:1},a=s[t.priority]-s[e.priority];return 0!==a?a:t.amount-e.amount}).slice(0,5),x=t.filter(e=>"quality"===e.status).sort((e,t)=>{let s=new Date(e.created_at||0).getTime(),a=new Date(t.created_at||0).getTime();return a-s}).slice(0,5);return(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-lg font-semibold",children:"Leads Overview"}),(0,a.jsxs)(j.z,{variant:"ghost",size:"sm",onClick:s,className:"text-blue-600 hover:text-blue-700",children:[a.jsx(m.Z,{className:"h-4 w-4 mr-1"}),"View All"]})]}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Leads"}),a.jsx(i.C,{variant:"outline",className:"font-bold",children:x.length})]}),a.jsx("div",{className:"space-y-3",children:0===x.length?(0,a.jsxs)("div",{className:"text-center py-4 text-muted-foreground",children:[a.jsx(W.Z,{className:"h-6 w-6 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No leads yet"})]}):x.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx("span",{children:e.company?.name}),a.jsx("span",{children:"•"}),(0,a.jsxs)("span",{children:["₹",e.amount.toLocaleString()]})]})]}),a.jsx(i.C,{variant:"high"===e.priority?"destructive":"medium"===e.priority?"default":"secondary",className:"text-xs",children:e.priority})]},e.id||`lead-${t}`))}),(0,a.jsxs)(j.z,{onClick:s,className:"w-full",variant:"outline",children:[a.jsx(el.Z,{className:"h-4 w-4 mr-2"}),"Add New Lead"]})]})})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-lg font-semibold",children:"Contacts Overview"}),(0,a.jsxs)(j.z,{variant:"ghost",size:"sm",onClick:l,className:"text-green-600 hover:text-green-700",children:[a.jsx(m.Z,{className:"h-4 w-4 mr-1"}),"View All"]})]}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Contacts"}),a.jsx(i.C,{variant:"outline",className:"font-bold",children:e.length})]}),a.jsx("div",{className:"space-y-3",children:0===c.length?(0,a.jsxs)("div",{className:"text-center py-4 text-muted-foreground",children:[a.jsx(W.Z,{className:"h-6 w-6 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No contacts yet"})]}):c.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"text-sm font-medium truncate",children:[e.first_name," ",e.last_name]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx("span",{children:e.position||"No position"}),e.company&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("span",{children:"•"}),a.jsx("span",{children:e.company.name})]})]})]}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"})]},e.id||`contact-${t}`))}),(0,a.jsxs)(j.z,{onClick:l,className:"w-full",variant:"outline",children:[a.jsx(el.Z,{className:"h-4 w-4 mr-2"}),"Add New Contact"]})]})})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(n.ll,{className:"text-lg font-semibold",children:"Hot Opportunities"}),(0,a.jsxs)(j.z,{variant:"ghost",size:"sm",onClick:r,className:"text-orange-600 hover:text-orange-700",children:[a.jsx(m.Z,{className:"h-4 w-4 mr-1"}),"View All"]})]}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Active Deals"}),a.jsx(i.C,{variant:"outline",className:"font-bold",children:d.length})]}),a.jsx("div",{className:"space-y-3",children:0===d.length?(0,a.jsxs)("div",{className:"text-center py-4 text-muted-foreground",children:[a.jsx(h.Z,{className:"h-6 w-6 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No opportunities yet"})]}):d.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:e.title}),a.jsx(i.C,{variant:"high"===e.priority?"destructive":"medium"===e.priority?"default":"secondary",className:"text-xs",children:e.priority})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx("span",{children:e.company?.name}),a.jsx("span",{children:"•"}),(0,a.jsxs)("span",{children:[e.probability,"% chance"]})]})]}),a.jsx("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"text-sm font-bold text-green-600",children:["₹",e.amount.toLocaleString()]})})]},e.id||`opp-${t}`))}),(0,a.jsxs)(j.z,{onClick:r,className:"w-full",variant:"outline",children:[a.jsx(o.Z,{className:"h-4 w-4 mr-2"}),"Add New Opportunity"]})]})})]})]})}var en=s(57936),ei=s(76904);function ec(){let e=(0,r.useRouter)(),{user:t,loading:s}=(0,ei.a)(),{opportunities:j,loading:g,error:f}=function(){let[e,t]=(0,l.useState)([]),[s,a]=(0,l.useState)(!0),[r,n]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=!0;return async function(){try{a(!0);let s=await en.x.getOpportunities();if(s.success&&e)t(s.data||[]),n(null);else throw Error(s.error||"Failed to fetch opportunities")}catch(t){e&&n(t instanceof Error?t.message:"An error occurred")}finally{e&&a(!1)}}(),()=>{e=!1}},[]);let i=async e=>{try{let s=await en.x.createOpportunity(e);if(s.success){let e=await en.x.getOpportunities();return e.success&&t(e.data||[]),s.data}throw Error(s.error||"Failed to add opportunity")}catch(e){throw n(e instanceof Error?e.message:"Failed to add opportunity"),e}},c=async(e,s)=>{try{let a=await en.x.updateOpportunity(e,s);if(a.success){let e=await en.x.getOpportunities();return e.success&&t(e.data||[]),a.data}throw Error(a.error||"Failed to update opportunity")}catch(e){throw n(e instanceof Error?e.message:"Failed to update opportunity"),e}},d=async e=>{try{let s=await en.x.deleteOpportunity(e);if(s.success){let e=await en.x.getOpportunities();e.success&&t(e.data||[])}else throw Error(s.error||"Failed to delete opportunity")}catch(e){throw n(e instanceof Error?e.message:"Failed to delete opportunity"),e}};return{opportunities:e,loading:s,error:r,addOpportunity:i,updateOpportunity:c,deleteOpportunity:d}}(),{activities:N,loading:w,error:b}=function(){let[e,t]=(0,l.useState)([]),[s,a]=(0,l.useState)(!0),[r,n]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=!0;return async function(){try{a(!0);let s=await en.x.getActivities();if(s.success&&e)t(s.data||[]),n(null);else throw Error(s.error||"Failed to fetch activities")}catch(t){e&&n(t instanceof Error?t.message:"An error occurred")}finally{e&&a(!1)}}(),()=>{e=!1}},[]);let i=async e=>{try{let s=await en.x.createActivity(e);if(s.success){let e=await en.x.getActivities();return e.success&&t(e.data||[]),s.data}throw Error(s.error||"Failed to add activity")}catch(e){throw n(e instanceof Error?e.message:"Failed to add activity"),e}},c=async(e,s)=>{try{let a=await en.x.updateActivity(e,s);if(a.success){let e=await en.x.getActivities();return e.success&&t(e.data||[]),a.data}throw Error(a.error||"Failed to update activity")}catch(e){throw n(e instanceof Error?e.message:"Failed to update activity"),e}},d=async e=>{try{let s=await en.x.deleteActivity(e);if(s.success){let e=await en.x.getActivities();e.success&&t(e.data||[])}else throw Error(s.error||"Failed to delete activity")}catch(e){throw n(e instanceof Error?e.message:"Failed to delete activity"),e}};return{activities:e,loading:s,error:r,addActivity:i,updateActivity:c,deleteActivity:d}}(),[y,Z]=(0,l.useState)([]),[_,C]=(0,l.useState)([]),[L,O]=(0,l.useState)([]),[S,M]=(0,l.useState)(!0),[P,R]=(0,l.useState)(new Date),[T,k]=(0,l.useState)(!1),[A,F]=(0,l.useState)(!1),[Y,E]=(0,l.useState)(0);(0,l.useEffect)(()=>{let e=!0;async function a(){try{console.log("Fetching dashboard data for user:",t?.email);let s=await en.x.getExpenses(),a=s.success?s.data:[],l=await en.x.getContacts(),r=l.success?l.data:[],n=await en.x.getCompanies(),i=n.success?n.data:[];e&&(Z(a||[]),C(r||[]),O(i||[]),R(new Date),M(!1),console.log("Dashboard data loaded successfully"))}catch(t){console.error("Error fetching additional data:",t),e&&M(!1)}}t&&!s&&a();let l=setTimeout(()=>k(!0),100);return()=>{e=!1,clearTimeout(l)}},[]);let $=(0,l.useMemo)(()=>{let e=j||[],t=y||[],s=e.length,a=e.filter(e=>"closed_win"===e.status).length,l=e.filter(e=>"lost"===e.status).length,r=e.filter(e=>["purpose","negotiate"].includes(e.status)).length,n=e.filter(e=>"closed_win"===e.status).reduce((e,t)=>e+Number(t.amount||0),0),i=e.filter(e=>!["closed_win","lost"].includes(e.status)).reduce((e,t)=>e+Number(t.forecast_amount||t.amount||0),0),c=t.reduce((e,t)=>e+Number(t.amount||0),0);return{totalOpportunities:s,wonOpportunities:a,lostOpportunities:l,qualifiedOpportunities:r,totalRevenue:n,forecastRevenue:i,winRate:s>0?a/s*100:0,conversionRate:r>0?a/r*100:0,avgDealSize:a>0?n/a:0,totalExpenses:c,profitMargin:n>0?(n-c)/n*100:0,isLoading:g||w||S}},[j,y,g,w,S]),H=(0,l.useMemo)(()=>[{name:"Quality",value:j.filter(e=>"quality"===e.status).length,color:"#6366f1",amount:j.filter(e=>"quality"===e.status).reduce((e,t)=>e+Number(t.amount),0)},{name:"Meet Contact",value:j.filter(e=>"meet_contact"===e.status).length,color:"#3b82f6",amount:j.filter(e=>"meet_contact"===e.status).reduce((e,t)=>e+Number(t.amount),0)},{name:"Meet & Present",value:j.filter(e=>"meet_present"===e.status).length,color:"#06b6d4",amount:j.filter(e=>"meet_present"===e.status).reduce((e,t)=>e+Number(t.amount),0)},{name:"Purpose",value:j.filter(e=>"purpose"===e.status).length,color:"#10b981",amount:j.filter(e=>"purpose"===e.status).reduce((e,t)=>e+Number(t.amount),0)},{name:"Negotiate",value:j.filter(e=>"negotiate"===e.status).length,color:"#f59e0b",amount:j.filter(e=>"negotiate"===e.status).reduce((e,t)=>e+Number(t.amount),0)},{name:"Won",value:$.wonOpportunities,color:"#22c55e",amount:$.totalRevenue}],[j,$]),W=(0,l.useMemo)(()=>{let e=new Date().getMonth(),t=new Date().getFullYear(),s=j.filter(e=>"closed_win"===e.status).reduce((e,t)=>{let s=new Date(t.updated_at||t.created_at||Date.now()),a=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;return e[a]=(e[a]||0)+Number(t.amount||0),e},{});return["Jan","Feb","Mar","Apr","May","Jun"].map((a,l)=>{let r=new Date(t,l,1),n=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,i=s[n]||0,c=l<=e?1.2*i:Math.max(.15*$.totalRevenue,5e4);return{month:a,revenue:i,target:c,actual:i}})},[j,$.totalRevenue]),K=(0,l.useMemo)(()=>{let e=j.reduce((e,t)=>{let s=t.sector||"Unknown",a=e.find(e=>e.name===s);return a?(a.value+=Number(t.amount),a.count+=1,a.won+="closed_win"===t.status?1:0):e.push({name:s,value:Number(t.amount),count:1,won:"closed_win"===t.status?1:0}),e},[]);return e.map(e=>({...e,winRate:e.count>0?e.won/e.count*100:0}))},[j]),G=(0,l.useMemo)(()=>N.filter(e=>"completed"===e.status).sort((e,t)=>{let s=new Date(t.updated_at||t.created_at||Date.now()).getTime(),a=new Date(e.updated_at||e.created_at||Date.now()).getTime();return s-a}).slice(0,5),[N]),Q=(0,l.useMemo)(()=>{let e=[];$.winRate>30?e.push({type:"success",message:"Great win rate! Keep up the excellent work.",icon:c.Z}):$.winRate<15&&e.push({type:"warning",message:"Win rate could be improved. Focus on qualification.",icon:d.Z}),$.profitMargin>20&&e.push({type:"success",message:"Healthy profit margins detected.",icon:o.Z});let t=N.filter(e=>"scheduled"===e.status&&new Date(e.start_time)<new Date);return t.length>0&&e.push({type:"error",message:`${t.length} overdue activities need attention.`,icon:x.Z}),e},[$.winRate,$.profitMargin,N]);return f||b?a.jsx("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center text-red-600",children:[(0,a.jsxs)("p",{children:["Error loading dashboard: ",f||b]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 border rounded hover:bg-gray-50",children:"Retry"})]})}):(0,a.jsxs)("div",{className:"space-y-6 p-4 sm:p-6",children:[a.jsx(v,{lastUpdated:P,refreshing:A,notifications:Y,onRefresh:()=>{F(!0),setTimeout(()=>{R(new Date),F(!1)},1e3)}}),Q.length>0&&a.jsx(n.Zb,{className:"border-l-4 border-l-blue-500 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20",children:a.jsx(n.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-1 bg-blue-100 dark:bg-blue-900 rounded-full",children:a.jsx(m.Z,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Performance Insights"}),a.jsx("div",{className:"space-y-1",children:Q.map((e,t)=>{let s=e.icon;return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(s,{className:`h-4 w-4 ${"success"===e.type?"text-green-600":"warning"===e.type?"text-yellow-600":"text-red-600"}`}),a.jsx("span",{children:e.message})]},t)})})]})]})})}),a.jsx(D,{metrics:$,animateCards:T}),a.jsx(V,{activities:N||[],opportunities:j||[],contacts:_||[]}),a.jsx(q,{revenueTrendData:W,pipelineData:H,sectorData:K}),a.jsx(X,{opportunities:j||[],expenses:y||[],contacts:_||[],companies:L||[]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[a.jsx(z,{sectorData:K}),a.jsx(ee,{expenses:y}),a.jsx(et,{opportunities:j})]}),a.jsx(ea,{activities:N}),a.jsx(er,{contacts:_||[],opportunities:j||[],onNavigateToLeads:()=>{e.push("/opportunities?status=lead")},onNavigateToContacts:()=>{e.push("/contacts")},onNavigateToOpportunities:()=>{e.push("/opportunities")}}),a.jsx(B,{opportunities:j||[]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(u.Z,{className:"h-5 w-5 text-green-600"}),"Recent Activities",a.jsx(i.C,{variant:"outline",className:"ml-auto",children:G.length})]})}),a.jsx(n.aY,{children:a.jsx("div",{className:"space-y-3",children:0===G.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(u.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),a.jsx("p",{className:"text-sm",children:"No recent activities"})]}):G.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 hover:bg-muted/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,p.ZP)(new Date(e.updated_at||e.created_at||Date.now()),"MMM dd, HH:mm")," • ",e.type]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(c.Z,{className:"h-4 w-4 text-green-500"}),a.jsx(i.C,{variant:"default",className:"text-xs",children:"Completed"})]})]},e.id))})})]}),(0,a.jsxs)(n.Zb,{className:"transition-all duration-700 hover:shadow-lg",children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[a.jsx(h.Z,{className:"h-5 w-5 text-orange-600"}),"Top Opportunities",a.jsx(i.C,{variant:"outline",className:"ml-auto",children:"Hot Deals"})]})}),a.jsx(n.aY,{children:a.jsx("div",{className:"space-y-3",children:j.filter(e=>!["closed_win","lost"].includes(e.status)).sort((e,t)=>Number(t.amount)-Number(e.amount)).slice(0,5).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3 hover:bg-muted/50 transition-colors group",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:e.title}),a.jsx(i.C,{variant:"high"===e.priority?"destructive":"medium"===e.priority?"default":"secondary",className:"text-xs",children:e.priority})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx("p",{className:"truncate",children:e.company?.name}),a.jsx("span",{children:"•"}),(0,a.jsxs)("p",{children:[e.probability,"% chance"]})]})]}),(0,a.jsxs)("div",{className:"text-right ml-2",children:[(0,a.jsxs)("p",{className:"text-sm font-bold text-green-600",children:["₹",Number(e.amount).toLocaleString()]}),a.jsx("div",{className:"flex items-center gap-1",children:a.jsx("div",{className:"w-8 h-1 bg-gray-200 rounded-full",children:a.jsx("div",{className:"h-1 bg-blue-500 rounded-full",style:{width:`${e.probability}%`}})})})]})]},e.id))})})]})]})]})}},54165:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>r,default:()=>c});var a=s(17536);let l=(0,a.createProxy)(String.raw`d:\ACPL ALL Projects\5th Projects\CRM_2.0\CRM-main\app\page.tsx`),{__esModule:r,$$typeof:n}=l,i=l.default,c=i}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[800,7874,4395,2978,2237,7552],()=>s(82414));module.exports=a})();